(this["webpackJsonp_react-admin-drag"]=this["webpackJsonp_react-admin-drag"]||[]).push([[5],{2495:function(e,t,a){"use strict";a.r(t);var n,r,c,l=a(13),u=a.n(l),i=(a(138),a(65)),o=(a(43),a(26)),s=a(27),d=a(5),b=(a(62),a(15)),j=a(7),f=a(0),m=a(10),O=a(23),h=a(2505),p=(a(139),a(59)),x=(a(140),a(39)),v=(a(2510),a(2512)),g=(a(58),a(35)),y=a(30),k=a(22),S=a(50),w=a(75),C=a(66),I=a(67),F=a(28),T=a(1),E=Object(m.renderTableCheckbox)(m.Table),P=Object(O.a)()((c=r=function(e){Object(C.a)(a,e);var t=Object(I.a)(a);function a(){var e;Object(S.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={loading:!1,dataSource:[],roles:[]},e.columns=[{title:"\u89d2\u8272\u540d",dataIndex:"name",key:"name"},{title:"\u63cf\u8ff0",dataIndex:"remark",key:"remark"}],e.handleSearch=Object(s.a)(u.a.mark((function t(){var a,n,r;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.state.loading){t.next=2;break}return t.abrupt("return");case 2:return t.prev=2,e.setState({loading:!0}),t.next=6,e.props.ajax.get("/role/queryEnabledRoles");case 6:a=t.sent,n=a||[],F.j?(r=[],n.forEach((function(e){var t=e.systemId,a=e.systemName;if(!t)return r.push(e);var n=r.find((function(e){return e.systemId===t}));n?n.children.push(e):(n={id:"systemId-".concat(t),systemId:t,name:a,type:4,children:[e]},r.push(n))})),r.sort((function(e,t){return e.type<t.type?-1:1})),r.forEach((function(e){var t=e.children;t&&t.sort((function(e,t){return e.type<t.type?-1:1}))})),n=r):n=n.filter((function(e){return 2!==e.type})),n.sort((function(e,t){return e.type<t.type?-1:1})),e.setState({dataSource:Object(k.a)(n),roles:n,loading:!1}),t.next=17;break;case 13:throw t.prev=13,t.t0=t.catch(2),e.setState({loading:!1}),t.t0;case 17:case"end":return t.stop()}}),t,null,[[2,13]])}))),e.handleSearchValue=function(t){var a=e.state.roles,n=Object(m.filterTree)(a,(function(e){return[e.name,e.remark].some((function(e){return(e||"").toLowerCase().includes(t)}))}));e.setState({dataSource:n})},e.handleChange=function(t){e.timer&&clearTimeout(e.timer),e.timer=setTimeout((function(){return e.handleSearchValue(t.target.value)}),300)},e}return Object(w.a)(a,[{key:"componentDidMount",value:function(){var e=this;Object(s.a)(u.a.mark((function t(){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.handleSearch();case 2:case"end":return t.stop()}}),t)})))()}},{key:"render",value:function(){var e=this.state,t=e.dataSource,a=e.loading,n=this.props,r=n.value,c=n.onChange,l=n.fullValue,u=(n.disabled,n.getCheckboxProps),i=void 0===u?function(){return{}}:u,o=Object(y.a)(n,["value","onChange","fullValue","disabled","getCheckboxProps"]);return Object(T.jsxs)(T.Fragment,{children:[Object(T.jsx)("div",{style:{padding:8,display:"flex",alignItems:"center"},children:Object(T.jsx)(g.default.Search,{style:{flex:1},allowClear:!0,placeholder:"\u8f93\u5165\u5173\u952e\u5b57\u8fdb\u884c\u641c\u7d22",onSearch:this.handleSearchValue,onChange:this.handleChange})}),Object(T.jsx)(E,Object(d.a)({showHeader:!0,size:"small",rowSelection:{getCheckboxProps:i,selectedRowKeys:l?(r||[]).map((function(e){return e.id})):r,onChange:function(e,t){return c(l?t:e)}},loading:a,columns:this.columns,dataSource:t,pagination:!1,rowKey:"id"},o))]})}}]),a}(f.Component),r.defaultProps={value:[],onChange:function(){},fullValue:!1},n=c))||n,V=Object(O.a)({modal:{title:function(e){var t;return null!==e&&void 0!==e&&null!==(t=e.record)&&void 0!==t&&t.isDetail?"\u67e5\u770b\u7528\u6237":e.isEdit?"\u7f16\u8f91\u7528\u6237":"\u521b\u5efa\u7528\u6237"},width:"70%",top:50}})((function(e){var t=e.record,a=e.isEdit,n=e.onOk,r=e.onCancel,c=Object(f.useState)(!1),l=Object(j.a)(c,2),i=l[0],O=l[1],h=b.default.useForm(),g=Object(j.a)(h,1)[0],y=null===t||void 0===t?void 0:t.isDetail;e.ajax.useGet("/user/getUserById",{id:null===t||void 0===t?void 0:t.id},[],{mountFire:a,setLoading:O,formatResult:function(e){e&&g.setFieldsValue(e)}});var k=e.ajax.usePost("/user/addUser",null,{setLoading:O,successTip:"\u521b\u5efa\u6210\u529f\uff01"}).run,S=e.ajax.usePost("/user/updateUserById",null,{setLoading:O,successTip:"\u4fee\u6539\u6210\u529f\uff01"}).run,w=e.ajax.useGet("/user/getOneUser").run;function C(){return(C=Object(s.a)(u.a.mark((function e(t){var r,c,l;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c=null===(r=t.roleIds)||void 0===r?void 0:r.filter((function(e){return!"".concat(e).startsWith("systemId")})),l=Object(d.a)(Object(d.a)({},t),{},{roleIds:c}),!a){e.next=7;break}return e.next=5,S(l);case 5:e.next=9;break;case 7:return e.next=9,k(l);case 9:n();case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var I=Object(m.useDebounceValidator)(function(){var e=Object(s.a)(u.a.mark((function e(t,n){var r,c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,w({account:n});case 4:if(r=e.sent){e.next=7;break}return e.abrupt("return");case 7:if(c=g.getFieldValue("id"),!a||r.id===c||r.account!==n){e.next=10;break}throw Error("\u8d26\u53f7\u4e0d\u80fd\u91cd\u590d\uff01");case 10:if(a||r.account!==n){e.next=12;break}throw Error("\u8d26\u53f7\u4e0d\u80fd\u91cd\u590d\uff01");case 12:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}()),F=y,E={labelCol:{flex:"100px"},disabled:F},V={xs:{span:24},sm:{span:12}};return Object(T.jsx)(b.default,{form:g,name:"roleEdit",onFinish:function(e){return C.apply(this,arguments)},initialValues:{enabled:!0},children:Object(T.jsxs)(m.ModalContent,{loading:i,okText:"\u4fdd\u5b58",okHtmlType:"submit",cancelText:"\u91cd\u7f6e",onCancel:function(){return g.resetFields()},footer:F?Object(T.jsx)(o.default,{onClick:r,children:"\u5173\u95ed"}):void 0,children:[a?Object(T.jsx)(m.FormItem,{hidden:!0,name:"id"}):null,Object(T.jsxs)(p.default,{gutter:8,children:[Object(T.jsx)(x.default,Object(d.a)(Object(d.a)({},V),{},{children:Object(T.jsx)(v.default,{title:"\u57fa\u7840\u4fe1\u606f",children:Object(T.jsxs)(m.Content,{fitHeight:!0,otherHeight:160,children:[Object(T.jsx)(m.FormItem,Object(d.a)(Object(d.a)({},E),{},{label:"\u8d26\u53f7",name:"account",required:!0,noSpace:!0,rules:[{validator:I}]})),Object(T.jsx)(m.FormItem,Object(d.a)(Object(d.a)({},E),{},{label:"\u5bc6\u7801",name:"password",required:!0,noSpace:!0})),Object(T.jsx)(m.FormItem,Object(d.a)(Object(d.a)({},E),{},{type:"switch",label:"\u542f\u7528",name:"enabled",checkedChildren:"\u542f",unCheckedChildren:"\u7981",required:!0})),Object(T.jsx)(m.FormItem,Object(d.a)(Object(d.a)({},E),{},{label:"\u59d3\u540d",name:"name",required:!0,noSpace:!0})),Object(T.jsx)(m.FormItem,Object(d.a)(Object(d.a)({},E),{},{label:"\u90ae\u7bb1",name:"email",rules:[m.validateRules.email()],required:!0,noSpace:!0})),Object(T.jsx)(m.FormItem,Object(d.a)(Object(d.a)({},E),{},{label:"\u624b\u673a\u53f7",name:"mobile",rules:[m.validateRules.mobile()],required:!0,noSpace:!0}))]})})})),Object(T.jsx)(x.default,Object(d.a)(Object(d.a)({},V),{},{children:Object(T.jsx)(v.default,{title:"\u89d2\u8272\u914d\u7f6e",bodyStyle:{padding:0},children:Object(T.jsx)(m.FormItem,Object(d.a)(Object(d.a)({},E),{},{name:"roleIds",children:Object(T.jsx)(P,{fitHeight:!0,otherHeight:200,getCheckboxProps:function(){return{disabled:F}}})}))})}))]})]})})}));t.default=Object(O.a)({path:"/users"})((function(e){var t=Object(f.useState)(!1),a=Object(j.a)(t,2),n=a[0],r=a[1],c=Object(f.useState)(1),l=Object(j.a)(c,2),O=l[0],p=l[1],x=Object(f.useState)(20),v=Object(j.a)(x,2),g=v[0],y=v[1],k=Object(f.useState)({position:"01"}),S=Object(j.a)(k,2),w=S[0],C=S[1],I=Object(f.useState)(!1),F=Object(j.a)(I,2),E=F[0],P=F[1],q=Object(f.useState)(null),N=Object(j.a)(q,2),D=N[0],H=N[1],L=b.default.useForm(),U=Object(j.a)(L,1)[0],R=Object(f.useMemo)((function(){return Object(d.a)(Object(d.a)({},w),{},{pageNum:O,pageSize:g})}),[w,O,g]),_=function(){return C(U.getFieldsValue())},z=e.ajax.useGet("/user/queryUsersByPage",R,[R],{setLoading:r,formatResult:function(e){return{dataSource:(null===e||void 0===e?void 0:e.content)||[],total:(null===e||void 0===e?void 0:e.totalElements)||0}}}).data,B=(z=void 0===z?{}:z).dataSource,M=z.total,G=e.ajax.useDel("/user/:id",null,{setLoading:r,successTip:"\u5220\u9664\u6210\u529f\uff01"}).run,K=[{title:"\u8d26\u53f7",dataIndex:"account"},{title:"\u59d3\u540d",dataIndex:"name"},{title:"\u542f\u7528",dataIndex:"enabled",render:function(e){return h.default.enabled.getTag(!!e)}},{title:"\u624b\u673a\u53f7",dataIndex:"mobile"},{title:"\u90ae\u7bb1",dataIndex:"email"},{title:"\u64cd\u4f5c",key:"operator",width:250,render:function(e,t){var a=t.id,n=t.name,r=[{label:"\u67e5\u770b",onClick:function(){return H(Object(d.a)(Object(d.a)({},t),{},{isDetail:!0}))||P(!0)}},{label:"\u4fee\u6539",onClick:function(){return H(t)||P(!0)}},{label:"\u5220\u9664",color:"red",confirm:{title:"\u60a8\u786e\u5b9a\u5220\u9664\u300c".concat(n,"\u300d\u5417\uff1f"),onConfirm:function(){return function(e){return J.apply(this,arguments)}(a)}}}];return Object(T.jsx)(m.Operator,{items:r})}}];function J(){return(J=Object(s.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,G(t);case 2:_();case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var A={style:{width:200}};return Object(T.jsxs)(m.PageContent,{loading:n,children:[Object(T.jsx)(m.QueryBar,{children:Object(T.jsxs)(b.default,{name:"user",layout:"inline",form:U,initialValues:w,onFinish:function(e){return p(1)||C(e)},children:[Object(T.jsx)(m.FormItem,Object(d.a)(Object(d.a)({},A),{},{label:"\u8d26\u53f7",name:"account"})),Object(T.jsx)(m.FormItem,Object(d.a)(Object(d.a)({},A),{},{label:"\u59d3\u540d",name:"name"})),Object(T.jsx)(m.FormItem,Object(d.a)(Object(d.a)({},A),{},{label:"\u624b\u673a\u53f7",name:"mobile"})),Object(T.jsx)(m.FormItem,Object(d.a)(Object(d.a)({},A),{},{label:"\u804c\u4f4d",name:"position",allowClear:!0,options:[{value:"01",label:"\u524d\u7aef\u5f00\u53d1"},{value:"02",label:"\u540e\u7aef\u5f00\u53d1"}]})),Object(T.jsx)(m.FormItem,{children:Object(T.jsxs)(i.default,{children:[Object(T.jsx)(o.default,{type:"primary",htmlType:"submit",children:"\u67e5\u8be2"}),Object(T.jsx)(o.default,{onClick:function(){return U.resetFields()},children:"\u91cd\u7f6e"})]})})]})}),Object(T.jsx)(m.ToolBar,{children:Object(T.jsx)(o.default,{type:"primary",onClick:function(){return H(null)||P(!0)},children:"\u6dfb\u52a0"})}),Object(T.jsx)(m.Table,{serialNumber:!0,pageNum:O,pageSize:g,fitHeight:!0,dataSource:B,columns:K,rowKey:"id"}),Object(T.jsx)(m.Pagination,{total:M,pageNum:O,pageSize:g,onPageNumChange:p,onPageSizeChange:function(e){return p(1)||y(e)}}),Object(T.jsx)(V,{visible:E,record:D,isEdit:!!D,onOk:function(){return P(!1)||_()},onCancel:function(){return P(!1)}})]})}))},2505:function(e,t,a){"use strict";a.r(t);var n=a(7),r=a(10),c={},l=a(2506);l.keys().forEach((function(e){if(!["./index.js"].includes(e)){var t=l(e).default;Object.entries(t).forEach((function(t){var a=Object(n.a)(t,2),r=a[0],l=a[1];if(r in c)throw Error("".concat(e," \u6587\u4ef6\u4e2d key \u300c").concat(r,"\u300d\u5df2\u88ab\u4f7f\u7528\uff01\u8bf7\u66f4\u6362\uff01"));c[r]=l}))}})),Object(r.wrapperOptions)(c,5e3),t.default=c},2506:function(e,t,a){var n={"./index.js":2505,"./system.js":2507};function r(e){var t=c(e);return a(t)}function c(e){if(!a.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}r.keys=function(){return Object.keys(n)},r.resolve=c,e.exports=r,r.id=2506},2507:function(e,t,a){"use strict";a.r(t);var n=a(13),r=a.n(n),c=a(27),l=(a(299),a(237)),u=a(191),i=a(1);t.default={menuTarget:[{value:"menu",label:"\u5e94\u7528\u83dc\u5355"},{value:"qiankun",label:"\u4e7e\u5764\u5b50\u5e94\u7528"},{value:"iframe",label:"iframe\u5185\u5d4c\u7b2c\u4e09\u65b9"},{value:"_self",label:"\u5f53\u524d\u7a97\u53e3\u6253\u5f00\u7b2c\u4e09\u65b9"},{value:"_blank",label:"\u65b0\u5f00\u7a97\u53e3\u6253\u5f00\u7b2c\u4e09\u65b9"}],yesNo:[{value:!0,label:"\u662f",tag:Object(i.jsx)(l.default,{color:"green",children:"\u662f"})},{value:!1,label:"\u5426",tag:Object(i.jsx)(l.default,{color:"red",children:"\u5426"})}],enabled:[{value:!0,label:"\u542f\u7528",tag:Object(i.jsx)(l.default,{color:"green",children:"\u542f\u7528"})},{value:!1,label:"\u7981\u7528",tag:Object(i.jsx)(l.default,{color:"red",children:"\u7981\u7528"})}],sex:[{value:"1",label:"\u7537"},{value:"2",label:"\u5973"},{value:"3",label:"\u672a\u77e5"}],system:function(){return Object(c.a)(r.a.mark((function e(){var t;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.b.get("/menu/queryTopMenus");case 2:return t=e.sent,e.abrupt("return",t.map((function(e){return{value:e.id,label:e.title,meta:e}})));case 4:case"end":return e.stop()}}),e)})))()},action:function(){return[{value:"add",label:"\u6dfb\u52a0"}]},get demo(){return[]}}},2510:function(e,t,a){"use strict";a(31),a(2511),a(156),a(139),a(140)},2511:function(e,t,a){},2512:function(e,t,a){e.exports=a(14)(954)}}]);
//# sourceMappingURL=5.60891455.chunk.js.map