{"version":3,"sources":["pages/role/RoleSelectTable.jsx","pages/user/EditModal.jsx","pages/user/index.jsx","options/index.js","options sync nonrecursive //.js$","options/system.js","../node_modules/antd/es/card/style/index.js","../delegated 954 from dll-reference vendor_5cc95c36df293e46d5fa"],"names":["WithCheckboxTable","renderTableCheckbox","Table","RoleSelectTable","config","state","loading","dataSource","roles","columns","title","dataIndex","key","handleSearch","a","setState","props","ajax","get","res","WITH_SYSTEMS","systems","forEach","item","systemId","systemName","push","system","find","sys","children","id","name","type","sort","b","filter","handleSearchValue","value","filterTree","node","remark","some","val","toLowerCase","includes","handleChange","e","timer","clearTimeout","setTimeout","target","this","onChange","fullValue","disabled","getCheckboxProps","others","style","padding","display","alignItems","Search","flex","allowClear","placeholder","onSearch","showHeader","size","rowSelection","selectedRowKeys","map","selectedRows","pagination","rowKey","Component","defaultProps","modal","record","isDetail","isEdit","width","top","onOk","onCancel","useState","setLoading","useForm","form","useGet","mountFire","formatResult","setFieldsValue","save","usePost","successTip","run","update","fetchUserByAccount","values","roleIds","startsWith","params","checkAccount","useDebounceValidator","rule","account","user","getFieldValue","Error","layout","labelCol","colLayout","xs","span","sm","onFinish","initialValues","enabled","okText","okHtmlType","cancelText","resetFields","footer","onClick","undefined","hidden","gutter","fitHeight","otherHeight","label","required","noSpace","rules","validator","checkedChildren","unCheckedChildren","validateRules","email","mobile","bodyStyle","path","pageNum","setPageNum","pageSize","setPageSize","position","conditions","setConditions","visible","setVisible","setRecord","useMemo","refreshSearch","getFieldsValue","content","total","totalElements","data","deleteRecord","useDel","render","options","getTag","items","color","confirm","onConfirm","handleDelete","queryItem","htmlType","serialNumber","onPageNumChange","onPageSizeChange","EditModal","result","req","require","keys","default","Object","entries","k","wrapperOptions","webpackContext","webpackContextResolve","__webpack_require__","o","code","resolve","module","exports","menuTarget","yesNo","tag","sex","list","meta","action"],"mappings":"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","file":"static/js/5.60891455.chunk.js","sourcesContent":["import React, {Component} from 'react';\nimport PropTypes from 'prop-types';\nimport {Input} from 'antd';\nimport {\n    renderTableCheckbox,\n    Table,\n    filterTree,\n} from '@ra-lib/admin';\nimport config from 'src/commons/config-hoc';\nimport {WITH_SYSTEMS} from 'src/config';\n\nconst WithCheckboxTable = renderTableCheckbox(Table);\n\n@config()\nexport default class RoleSelectTable extends Component {\n    static propTypes = {\n        value: PropTypes.array,     // 选中的节点\n        onChange: PropTypes.func,   // 选择节点时，触发\n        fullValue: PropTypes.bool,  // value是否是角色全部数据\n    };\n\n    static defaultProps = {\n        value: [],\n        onChange: () => void 0,\n        fullValue: false,\n    };\n\n    state = {\n        loading: false,\n        dataSource: [], // table展示的角色数据，搜索时是roles子集\n        roles: [],      // 所有的角色数据\n    };\n\n    columns = [\n        {title: '角色名', dataIndex: 'name', key: 'name'},\n        {title: '描述', dataIndex: 'remark', key: 'remark'},\n    ];\n\n    componentDidMount() {\n        (async () => {\n            await this.handleSearch();\n        })();\n    }\n\n    handleSearch = async () => {\n        if (this.state.loading) return;\n\n        try {\n            this.setState({loading: true});\n            const res = await this.props.ajax.get('/role/queryEnabledRoles');\n\n            let roles = (res || []);\n            if (WITH_SYSTEMS) {\n                const systems = [];\n                roles.forEach(item => {\n                    const {systemId, systemName} = item;\n                    if (!systemId) return systems.push(item);\n\n                    let system = systems.find(sys => sys.systemId === systemId);\n                    if (!system) {\n                        system = {\n                            id: `systemId-${systemId}`,\n                            systemId,\n                            name: systemName,\n                            type: 4,\n                            children: [\n                                item,\n                            ],\n                        };\n                        systems.push(system);\n                    } else {\n                        system.children.push(item);\n                    }\n                });\n                systems.sort((a, b) => a.type < b.type ? -1 : 1);\n                systems.forEach(({children}) => {\n                    if (!children) return;\n                    children.sort((a, b) => a.type < b.type ? -1 : 1);\n                });\n\n                roles = systems;\n            } else {\n                roles = roles.filter(item => item.type !== 2);\n            }\n\n            roles.sort((a, b) => a.type < b.type ? -1 : 1);\n\n            this.setState({dataSource: [...roles], roles, loading: false});\n        } catch (e) {\n            this.setState({loading: false});\n            throw e;\n        }\n    };\n\n    handleSearchValue = (value) => {\n        const {roles} = this.state;\n\n        const dataSource = filterTree(roles, node => {\n            const {name, remark} = node;\n            return [name, remark].some(val => {\n                const lowerValue = (val || '').toLowerCase();\n                return lowerValue.includes(value);\n            });\n        });\n\n        this.setState({\n            dataSource,\n        });\n    };\n\n    handleChange = (e) => {\n        // 防抖\n        if (this.timer) clearTimeout(this.timer);\n\n        this.timer = setTimeout(() => this.handleSearchValue(e.target.value), 300);\n    };\n\n\n    render() {\n        const {\n            dataSource,\n            loading,\n        } = this.state;\n\n        const {\n            value,\n            onChange,\n            fullValue,\n            disabled,\n            getCheckboxProps = () => ({}),\n            ...others\n        } = this.props;\n\n        return (\n            <>\n                <div style={{padding: 8, display: 'flex', alignItems: 'center'}}>\n                    <Input.Search\n                        style={{flex: 1}}\n                        allowClear\n                        placeholder=\"输入关键字进行搜索\"\n                        onSearch={this.handleSearchValue}\n                        onChange={this.handleChange}\n                    />\n                </div>\n                <WithCheckboxTable\n                    showHeader={true}\n                    size=\"small\"\n                    rowSelection={{\n                        getCheckboxProps,\n                        selectedRowKeys: fullValue ? (value || []).map(item => item.id) : value,\n                        onChange: (selectedRowKeys, selectedRows) => onChange(fullValue ? selectedRows : selectedRowKeys),\n                    }}\n                    loading={loading}\n                    columns={this.columns}\n                    dataSource={dataSource}\n                    pagination={false}\n                    rowKey=\"id\"\n                    {...others}\n                />\n            </>\n        );\n    }\n}\n\n","import {useState} from 'react';\nimport {Form, Row, Col, Card, Button} from 'antd';\nimport {\n    ModalContent,\n    FormItem,\n    Content,\n    validateRules,\n    useDebounceValidator,\n} from '@ra-lib/admin';\nimport config from 'src/commons/config-hoc';\nimport RoleSelectTable from 'src/pages/role/RoleSelectTable';\n\nexport default config({\n    modal: {\n        title: props => {\n            if (props?.record?.isDetail) return '查看用户';\n\n            return props.isEdit ? '编辑用户' : '创建用户';\n        },\n        width: '70%',\n        top: 50,\n    },\n})(function Edit(props) {\n    const {record, isEdit, onOk, onCancel} = props;\n    const [loading, setLoading] = useState(false);\n    const [form] = Form.useForm();\n    const isDetail = record?.isDetail;\n\n    // 编辑时，查询详情数据\n    props.ajax.useGet('/user/getUserById', {id: record?.id}, [], {\n        mountFire: isEdit,\n        setLoading,\n        formatResult: res => {\n            if (!res) return;\n            form.setFieldsValue(res);\n        },\n    });\n    const {run: save} = props.ajax.usePost('/user/addUser', null, {setLoading, successTip: '创建成功！'});\n    const {run: update} = props.ajax.usePost('/user/updateUserById', null, {setLoading, successTip: '修改成功！'});\n    const {run: fetchUserByAccount} = props.ajax.useGet('/user/getOneUser');\n\n    async function handleSubmit(values) {\n        const roleIds = values.roleIds?.filter(id => !`${id}`.startsWith('systemId'));\n        const params = {\n            ...values,\n            roleIds,\n        };\n\n        if (isEdit) {\n            await update(params);\n        } else {\n            await save(params);\n        }\n\n        onOk();\n    }\n\n    const checkAccount = useDebounceValidator(async (rule, value) => {\n        if (!value) return;\n\n        const user = await fetchUserByAccount({account: value});\n        if (!user) return;\n\n        const id = form.getFieldValue('id');\n        if (isEdit && user.id !== id && user.account === value) throw Error('账号不能重复！');\n        if (!isEdit && user.account === value) throw Error('账号不能重复！');\n    });\n\n    const disabled = isDetail;\n    const layout = {\n        labelCol: {flex: '100px'},\n        disabled,\n    };\n    const colLayout = {\n        xs: {span: 24},\n        sm: {span: 12},\n    };\n    return (\n        <Form\n            form={form}\n            name=\"roleEdit\"\n            onFinish={handleSubmit}\n            initialValues={{enabled: true}}\n        >\n            <ModalContent\n                loading={loading}\n                okText=\"保存\"\n                okHtmlType=\"submit\"\n                cancelText=\"重置\"\n                onCancel={() => form.resetFields()}\n                footer={disabled ? <Button onClick={onCancel}>关闭</Button> : undefined}\n            >\n                {isEdit ? <FormItem hidden name=\"id\"/> : null}\n                <Row gutter={8}>\n                    <Col {...colLayout}>\n                        <Card title=\"基础信息\">\n                            <Content fitHeight otherHeight={160}>\n                                <FormItem\n                                    {...layout}\n                                    label=\"账号\"\n                                    name=\"account\"\n                                    required\n                                    noSpace\n                                    rules={[\n                                        {validator: checkAccount},\n                                    ]}\n                                />\n                                <FormItem\n                                    {...layout}\n                                    label=\"密码\"\n                                    name=\"password\"\n                                    required\n                                    noSpace\n                                />\n                                <FormItem\n                                    {...layout}\n                                    type={'switch'}\n                                    label=\"启用\"\n                                    name=\"enabled\"\n                                    checkedChildren=\"启\"\n                                    unCheckedChildren=\"禁\"\n                                    required\n                                />\n                                <FormItem\n                                    {...layout}\n                                    label=\"姓名\"\n                                    name=\"name\"\n                                    required\n                                    noSpace\n                                />\n                                <FormItem\n                                    {...layout}\n                                    label=\"邮箱\"\n                                    name=\"email\"\n                                    rules={[validateRules.email()]}\n                                    required\n                                    noSpace\n                                />\n                                <FormItem\n                                    {...layout}\n                                    label=\"手机号\"\n                                    name=\"mobile\"\n                                    rules={[validateRules.mobile()]}\n                                    required\n                                    noSpace\n                                />\n                            </Content>\n                        </Card>\n                    </Col>\n                    <Col {...colLayout}>\n                        <Card title=\"角色配置\" bodyStyle={{padding: 0}}>\n                            <FormItem\n                                {...layout}\n                                name=\"roleIds\"\n                            >\n                                <RoleSelectTable\n                                    fitHeight\n                                    otherHeight={200}\n                                    getCheckboxProps={() => ({disabled})}\n                                />\n                            </FormItem>\n                        </Card>\n                    </Col>\n                </Row>\n            </ModalContent>\n        </Form>\n    );\n});\n","import {useState, useMemo} from 'react';\nimport {Button, Form, Space} from 'antd';\nimport {\n    PageContent,\n    QueryBar,\n    FormItem,\n    Table,\n    Pagination,\n    Operator,\n    ToolBar,\n} from '@ra-lib/admin';\nimport config from 'src/commons/config-hoc';\nimport options from 'src/options';\nimport EditModal from './EditModal';\n\nexport default config({\n    path: '/users',\n})(function User(props) {\n    const [loading, setLoading] = useState(false);\n    const [pageNum, setPageNum] = useState(1);\n    const [pageSize, setPageSize] = useState(20);\n    const [conditions, setConditions] = useState({position: '01'});\n    const [visible, setVisible] = useState(false);\n    const [record, setRecord] = useState(null);\n    const [form] = Form.useForm();\n\n    const params = useMemo(() => {\n        return {\n            ...conditions,\n            pageNum,\n            pageSize,\n        };\n    }, [conditions, pageNum, pageSize]);\n\n    // 使用现有查询条件，重新发起请求\n    const refreshSearch = () => setConditions(form.getFieldsValue());\n\n    // 获取列表\n    const {\n        data: {\n            dataSource,\n            total,\n        } = {},\n    } = props.ajax.useGet('/user/queryUsersByPage', params, [params], {\n        setLoading,\n        formatResult: res => {\n            return {\n                dataSource: res?.content || [],\n                total: res?.totalElements || 0,\n            };\n        },\n    });\n\n    // 删除\n    const {run: deleteRecord} = props.ajax.useDel('/user/:id', null, {setLoading, successTip: '删除成功！'});\n\n    const columns = [\n        {title: '账号', dataIndex: 'account'},\n        {title: '姓名', dataIndex: 'name'},\n        {title: '启用', dataIndex: 'enabled', render: value => options.enabled.getTag(!!value)},\n        {title: '手机号', dataIndex: 'mobile'},\n        {title: '邮箱', dataIndex: 'email'},\n        {\n            title: '操作',\n            key: 'operator',\n            width: 250,\n            render: (value, record) => {\n                const {id, name} = record;\n                const items = [\n                    {\n                        label: '查看',\n                        onClick: () => setRecord({...record, isDetail: true}) || setVisible(true),\n                    },\n                    {\n                        label: '修改',\n                        onClick: () => setRecord(record) || setVisible(true),\n                    },\n                    {\n                        label: '删除',\n                        color: 'red',\n                        confirm: {\n                            title: `您确定删除「${name}」吗？`,\n                            onConfirm: () => handleDelete(id),\n                        },\n                    },\n                ];\n\n                return (<Operator items={items}/>);\n            },\n        },\n    ];\n\n    async function handleDelete(id) {\n        await deleteRecord(id);\n        // 触发列表更新\n        refreshSearch();\n    }\n\n    const queryItem = {\n        style: {width: 200},\n    };\n\n    return (\n        <PageContent loading={loading}>\n            <QueryBar>\n                <Form\n                    name=\"user\"\n                    layout=\"inline\"\n                    form={form}\n                    initialValues={conditions}\n                    onFinish={values => setPageNum(1) || setConditions(values)}\n                >\n                    <FormItem\n                        {...queryItem}\n                        label=\"账号\"\n                        name=\"account\"\n                    />\n                    <FormItem\n                        {...queryItem}\n                        label=\"姓名\"\n                        name=\"name\"\n                    />\n                    <FormItem\n                        {...queryItem}\n                        label=\"手机号\"\n                        name=\"mobile\"\n                    />\n                    <FormItem\n                        {...queryItem}\n                        label=\"职位\"\n                        name=\"position\"\n                        allowClear\n                        options={[\n                            {value: '01', label: '前端开发'},\n                            {value: '02', label: '后端开发'},\n                        ]}\n                    />\n                    <FormItem>\n                        <Space>\n                            <Button type=\"primary\" htmlType=\"submit\">查询</Button>\n                            <Button onClick={() => form.resetFields()}>重置</Button>\n                        </Space>\n                    </FormItem>\n                </Form>\n            </QueryBar>\n            <ToolBar>\n                <Button type=\"primary\" onClick={() => setRecord(null) || setVisible(true)}>添加</Button>\n            </ToolBar>\n            <Table\n                serialNumber\n                pageNum={pageNum}\n                pageSize={pageSize}\n                fitHeight\n                dataSource={dataSource}\n                columns={columns}\n                rowKey=\"id\"\n            />\n            <Pagination\n                total={total}\n                pageNum={pageNum}\n                pageSize={pageSize}\n                onPageNumChange={setPageNum}\n                onPageSizeChange={pageSize => setPageNum(1) || setPageSize(pageSize)}\n            />\n            <EditModal\n                visible={visible}\n                record={record}\n                isEdit={!!record}\n                onOk={() => setVisible(false) || refreshSearch()}\n                onCancel={() => setVisible(false)}\n            />\n        </PageContent>\n    );\n});\n","import {wrapperOptions} from '@ra-lib/admin';\n\n/**\n * 使用 require.context 自动引入所有model文件\n * */\nconst result = {};\n\n// src/models目录下，不支持子文件夹\nconst req = require.context('./', false, /\\.js$/);\nreq.keys().forEach(key => {\n    if ([\n        './index.js',\n    ].includes(key)) return;\n\n    const model = req(key);\n\n    const options = model.default;\n    Object.entries(options).forEach(([k, value]) => {\n        if (k in result) throw Error(`${key} 文件中 key 「${k}」已被使用！请更换！`);\n        result[k] = value;\n    });\n});\n\nwrapperOptions(result, 1000 * 5);\n\nexport default result;\n","var map = {\n\t\"./index.js\": 2505,\n\t\"./system.js\": 2507\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 2506;","import {Tag} from 'antd';\nimport ajax from 'src/commons/ajax';\n\n/**\n * 项目中可能用到的一些枚举类数据\n * 约定只含有三个参数，\n * {\n *  value: 1,      // 必须且不可重复\n *  label: '名称', // 必须\n *  meta: {},     // 其他数据，可缺省\n *  tag: Tag      // 标签\n * };\n *\n * // 扩展方法\n * options.menuTarget.getLabel('menu')\n * options.yesNo.getTag(true);\n * */\nexport default {\n    // 菜单目标\n    menuTarget: [\n        {value: 'menu', label: '应用菜单'},\n        {value: 'qiankun', label: '乾坤子应用'},\n        {value: 'iframe', label: 'iframe内嵌第三方'},\n        {value: '_self', label: '当前窗口打开第三方'},\n        {value: '_blank', label: '新开窗口打开第三方'},\n    ],\n    // 是否\n    yesNo: [\n        {value: true, label: '是', tag: <Tag color=\"green\">是</Tag>},\n        {value: false, label: '否', tag: <Tag color=\"red\">否</Tag>},\n    ],\n    // 启用、禁用\n    enabled: [\n        {value: true, label: '启用', tag: <Tag color=\"green\">启用</Tag>},\n        {value: false, label: '禁用', tag: <Tag color=\"red\">禁用</Tag>},\n    ],\n    // 性别\n    sex: [\n        {value: '1', label: '男'},\n        {value: '2', label: '女'},\n        {value: '3', label: '未知'},\n    ],\n    // 可以是函数，异步或同步都可以\n    async system() {\n        const list = await ajax.get('/menu/queryTopMenus');\n        return list.map(item => {\n            return {\n                value: item.id,\n                label: item.title,\n                meta: item,\n            };\n        });\n    },\n    action() {\n        return [\n            {value: 'add', label: '添加'},\n        ];\n        // throw Error('获取失败了');\n    },\n    // 使用 get\n    get demo() {\n        return [];\n    },\n};\n\n","import '../../style/index.less';\nimport './index.less'; // style dependencies\n\nimport '../../tabs/style';\nimport '../../row/style';\nimport '../../col/style';","module.exports = (__webpack_require__(14))(954);"],"sourceRoot":""}